@model DiscoveryCenter.Models.SurveyViewModel
@using DiscoveryCenter.Models

@{
    ViewBag.Title = "Home Page";
    Layout = "~/Views/Shared/_SurveyLayout.cshtml";
}
@using (Html.BeginForm("Survey", "Home", FormMethod.Post))
{
    <div class="jumbotron">

        <img src="~/Content/images/discovery75.png" />
        
        <a id="quitSurey" class="btn btn-lg pull-right" type="button" href="#" onclick="confirmExit();">
            <span class="glyphicon glyphicon-remove-circle pull-right" style="font-size:4em; color:red"></span>
        </a>
        <span id="alert" class="alert alert-danger top" role="alert" hidden style="position: absolute;"></span>

        <br />

        <!-- Left and right controls -->
        <a class="left carousel-control pull-left " href="#myCarousel" role="button" data-slide="prev" hidden>
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
            <span class="carousel-control-caption-prev">Previous</span>
        </a>
        <a class="right carousel-control pull-right" href="#myCarousel" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
            <span class="carousel-control-caption-next">Next</span>
        </a>

        @Html.HiddenFor(m => m.SurveyId)
        <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="false">

            <!-- Wrapper for slides -->
            <div class="carousel-inner" role="listbox">
                @for (int i = 0; i < @Model.QuestionModels.Count; i++)
                {
                    string val = i == 0 ? "item active" : "item";
                    <div class="@val" id="slide_@i">
                        @Html.HiddenFor(m => m.QuestionModels[i].Question)
                        @Html.HiddenFor(m => m.QuestionModels[i].QuestionId)
                        <p><b>@Model.QuestionModels[i].Question</b></p>
                        @switch (Model.QuestionModels[i].Type)
                        {
                            case (Question.QuestionType.MultipleChoiceChooseOne):
                                @(Html.Partial("MultipleChoiceChooseOne", Model.QuestionModels[i]))
                                break;

                            case (Question.QuestionType.MultipleChoiceChooseMany):
                                @(Html.Partial("MultipleChoiceChooseMany", Model.QuestionModels[i]))
                                break;

                            case (Question.QuestionType.ShortAnswer):
                                @Html.TextArea(String.Format("QuestionModels[{0}].Answer", Model.QuestionModels[i].QuestionId))
                                break;

                            case (Question.QuestionType.Slider):
                                @(Html.Partial("SliderQuestion", Model.QuestionModels[i]))
                                break;

                            case (Question.QuestionType.ExhibitsChooseMany):
                                @(Html.Partial("ExhibitsChooseMany", Model.QuestionModels[i]))
                                break;

                            case (Question.QuestionType.Spinner):
                                <input class="spinner" name=@(String.Format(" questionmodels[{0}].answer", Model.QuestionModels[i].QuestionId) )/>
                                break;

                            default:
                                @Html.HiddenFor(m => m.QuestionModels[i].Answer)
                                break;
                        }

                        @Html.HiddenFor(m => m.QuestionModels[i].Type)

                        @if (i == Model.QuestionModels.Count - 1)
                        {
                            <center>
                                <input type="submit" class="btn btn-default" value="Complete Survey" id="CompleteSurvey" style="margin-top:15%" />
                            </center>
                        }
                    </div>
                }
            </div>

            <br>
            <!-- Indicators -->
            <div class="carousel-controls center">
                <ol class="carousel-indicators">
                    <li data-target="#myCarousel" class="active" style="cursor:default"></li>
                    @for (int i = 1; i < @Model.QuestionModels.Count; i++)
                    {
                        <li data-target="#myCarousel" style="cursor:default"></li>
                    }
                </ol>
            </div>

        </div>
    </div>
}

@section scripts
{
    <script>

        function confirmExit() {
        if(confirm("Are you sure you wish to exit without submitting your answers?"))
            window.location.replace("@Url.Action("Index", "Home", new {id=Model.SurveyId},Request.Url.Scheme)");
        }
        numSlides = @Model.QuestionModels.Count -1;
    </script>
}

